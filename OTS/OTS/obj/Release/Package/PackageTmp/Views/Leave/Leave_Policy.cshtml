<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.0/jquery-confirm.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.0/jquery-confirm.min.js"></script>

<link href="http://cdn.rawgit.com/davidstutz/bootstrap-multiselect/master/dist/css/bootstrap-multiselect.css"
      rel="stylesheet" type="text/css" />
<script src="http://cdn.rawgit.com/davidstutz/bootstrap-multiselect/master/dist/js/bootstrap-multiselect.js"
        type="text/javascript"></script>

<style>
    .mybtncls.btnlast {
        list-style-type: none;
        float: right;
        padding-right: 4px !important;
        padding-left: 0px !important;
    }

    .mybtncls {
        list-style-type: none;
        padding-right: 4px !important;
        padding-left: 0px !important;
    }

        .mybtncls li {
            float: left;
            padding-left: 5px !important;
            padding-top: 5px !important;
        }

    .cmplitetextalign {
        margin-left: 18px;
    }

    div.jconfirm-title-c {
        <span class="jconfirm-icon-c"><i class="fa fa-smile-o"></i></span>
    }
</style>
<style type="text/css">
    .multiselect-container {
        width: 100% !important;
        border-radius: 0px !important;
    }

    .multiselect {
        height: 40px !important;
        text-align: left !important;
    }
    /*for table*/
    .dataTables_scrollHeadInner {
        width: 100% !important;
    }

    div.dataTables_scrollHeadInner table {
        width: 100% !important;
    }
</style>
<script>
    $(function () {
        $('#ddlgrade').multiselect({
            includeSelectAllOption: true,
            buttonWidth: '100%'
        });
        $(".caret").css('float', 'right');
        $(".caret").css('margin', '8px 0');
    });
    $(document).ready(function () {
        $('ul.list-unstyled  li a[href$="' + "/leavePolicy_History" + '"]').addClass('active');
        //$('.dataTables_filter').css("width", "100%");

        var table = $(".tblCreatePlan").DataTable(
            {
                "columnDefs": [
                    { "targets": [8], "orderable": false }
                ],
                "language": {
                    "search": "",
                    "searchPlaceholder": "Search",
                    "zeroRecords": " "
                },
                "lengthChange": false,
                "paging": false,
                "scrollResize": true,
                "scrollY": 400,
                "scrollCollapse": true,
                "paging": false

            }
        );
        //if (table.rows({ filter: 'applied' }).data().length == 0) {
        //    $(".table td:nth-child(1)").hide();
        //    //$(".tblCreatePlan").hide();
        //}
        $('.dataTables_filter input').css("width", 180);
        currentRow = null;
        var dt = new Date();
        var currentdate = new Date(myDateFormatter(dt));
        var startdate = new Date(myDateFormatter(dt));
        $('#txtEffectiveEndDate').datepicker("destroy");
        $('#txtEffectiveStartDate').datepicker("destroy");
        $('#txtStartdatepolicyplan').datepicker("destroy");
        $('#txtEnddatepolicyplan').datepicker("destroy");
        $('#txtEffectiveStartDate').datepicker({
            dateFormat: "dd-M-yy", closeText: 'Clear', showButtonPanel: true, changeMonth: true, minDate: new Date(currentdate), onClose: function () {
                var event = arguments.callee.caller.caller.arguments[0];
                // If "Clear" gets clicked, then really clear it
                if ($(event.delegateTarget).hasClass('ui-datepicker-close')) {
                    $(this).val('');
                }
            }
        }).attr('readonly', true).css('background-color', 'White');
        $(document).on("click", "#planterm", function () {
            // if ($('#tblCreatePlan   tr:eq(1)').find("td").eq(0).text().trim() != "") {
            //     if ($('#tblCreatePlan   tr:eq(1)').find("td").eq(6).text().trim() == "All") {
            //        $("#Employeetype").val('A').prop("disabled", true);
            //    } else {
            //        $("#Employeetype option:contains('A')").prop('disabled', true).css('background-color', 'lightgray');
            //    }
            //} else {
            //     $("#Employeetype option:contains('A')").prop('disabled', false).css('background-color', '#ffffff');
            //}

            $("#txtEnddatepolicyplan").val('').prop('disabled', false).css('background-color','#ffffff');
            $("#btnAddCreateRule").val('Submit').prop('disabled', false);
            $("#createrulehedding").text('Create Rule');
            $("#btnreset").show();
            $('#ddlgrade').multiselect('clearSelection');
            var dt = new Date();
            var currentdate = new Date(myDateFormatter(dt));
            var endddate = new Date(myDateFormatter($('#txtEffectiveEndDate').val()));
            var datefrom = new Date(myDateFormatter($('#txtEffectiveStartDate').val()));
            $('#txtStartdatepolicyplan').datepicker("destroy");
            $('#txtStartdatepolicyplan').datepicker({
                dateFormat: "dd-M-yy", closeText: 'Clear', showButtonPanel: true, changeMonth: true, minDate: new Date(datefrom), maxDate: new Date(endddate), onClose: function () {
                    var event = arguments.callee.caller.caller.arguments[0];
                    // If "Clear" gets clicked, then really clear it
                    if ($(event.delegateTarget).hasClass('ui-datepicker-close')) {
                        $(this).val('');
                    }
                }
            }).attr('readonly', true).css('background-color', 'White');
            datefrom.setDate(datefrom.getDate() + 1);
            $('#txtEnddatepolicyplan').datepicker("destroy");
            $('#txtEnddatepolicyplan').datepicker({
                dateFormat: "dd-M-yy", closeText: 'Clear', showButtonPanel: true, changeMonth: true, minDate: new Date(datefrom), maxDate: new Date(endddate), onClose: function () {
                    var event = arguments.callee.caller.caller.arguments[0];
                    // If "Clear" gets clicked, then really clear it
                    if ($(event.delegateTarget).hasClass('ui-datepicker-close')) {
                        $(this).val('');
                    }
                }
            }).attr('readonly', true).css('background-color', 'White');
            $("#Create_Plan").modal('show');
        });

        $("#btnsubmitpage").click(function () {
           $.ajax({
                type: 'POST',
                url: '/leave/leavepolicysubmit',
                contentType: 'application/json;charset=utf-8',
                data: {},
                dataType: 'json',
                success: function (response) {
                    var msgarr = [];
                    msgarr = response.msg.split(',');
                    if (msgarr[0] == "Success") {
                        alert(response.msg);
                        window.location.href = "/leave/LeavePolicy_History";
                    } else {
                        alert(response.msg);
                    }
                    //var succ = response.SuccessMsg;
                    //var err = response.ErrorMsg;
                    //if (succ != "" && err == "") {
                    //    alert(succ);
                    //}
                    //else {
                    //    alert(err);
                    //}
                }
            });
        });
        $(document).on("click", '#btnAddCreateRule', function () {

            var ddlgrade = [];
            var ddlgradetext = [];
            ddlgrade = $("#ddlgrade").val();
            ddlgradetext = $("#ddlgrade option:selected").map(function () { return $(this).text(); }).get().join(',').split(',');
            if (ddlgrade.length <= 0) {
                alert("Please Select Grade ! ");
                $("#ddlgrade").focus();
                return false;
            }

            if ($("#txtnoofdays").val() == "") {
                alert("Duration Can't be Blank ! ");
                $("#txtnoofdays").focus();
                return false;
            }
            if ($("#ddlUOM").val() == "0") {
                alert("Please Select UOM ! ");
                $("#ddlUOM").focus();
                return false;
            }
            if ($("#txtStartdatepolicyplan").val() == "") {
                alert("Start Date  Can't be Blank ! ");
                $("#txtStartdatepolicyplan").focus();
                return false;
            }

            if ($("#ddlislossofpay").val() == "0") {
                alert("Please Select Is loss of Pay  ! ");
                $("#ddlislossofpay").focus();
                return false;
            }
            if ($("#Employeetype").val() == "0") {
                alert("Please Select Employment Type  ! ");
                $("#Employeetype").focus();
                return false;
            }
            if ($("#ddlcreaterulestatus").val() == "0") {
                alert("Please Select Status  ! ");
                $("#ddlcreaterulestatus").focus();
                return false;
            }
            readonlyfalse();
            var count = $('#hdn_count').val();
            count = parseInt(count) + 1;
            $('#hdn_count').val(count);


            for (var i = 0; i < ddlgrade.length; i++) {

            var markup = "";
            markup += "<tr id='row" + i + "' data_id='rule" + $("#hiddenrowgroup").val() + "'  class='text-center rule" + $("#hiddenrowgroup").val() +"'>";
            markup += "<td  data_id='" + ddlgrade[i] + "'> " + ddlgradetext[i] + "</td > ";
            markup += "<td> " + $("#txtnoofdays").val() + "</td > ";
            markup += "<td  data_id='" + $("#ddlUOM").val() + "'> " + $("#ddlUOM  option:selected ").text() + "</td > ";
            markup += "<td> " + $("#txtStartdatepolicyplan").val() + "</td > ";
            markup += "<td> " + $("#txtEnddatepolicyplan").val() + "</td > ";
            markup += "<td  data_id='" + $("#ddlislossofpay").val() + "'> " + $("#ddlislossofpay  option:selected ").text() + "</td > ";
            markup += "<td  data_id='" + $("#Employeetype").val() + "'> " + $("#Employeetype  option:selected ").text() + "</td > ";
            markup += "<td  data_id='" + $("#ddlcreaterulestatus").val() + "'> " + $("#ddlcreaterulestatus").val() + "</td > ";
            markup += "<td> <a href='javascript:void(0)' class='font-18 btnEdit' title='Edit'><i class='fa fa-pencil m-r-5' aria-hidden='true'></i></a> <a href='javascript:void(0)' class='text-danger font-18 btnDelete' title='Remove'><i class='fa fa-trash-o' aria-hidden='true'></i></a></td>";
            markup += "</tr>";

            if (currentRow) { }
            else {
                table.row.add($(markup)).draw();
            }
            }
            $(this).prop('disabled', true);
            $('#Create_Plan').modal('hide');
            if (currentRow) {

                if (($("#hiddenrowenddate").val() != "" && $("#txtEnddatepolicyplan").val() != "") || $("#hiddenrowenddate").val() == "") {

                    var rowindex = $("#hiddenrowindex").val();
                    var dararow_id = $("#tblCreatePlan").find('tr:eq(' + (parseInt($("#hiddenrowindex").val()) + 1) + ')').attr('data_id');
                    table.rows('.' + dararow_id).each(function (index) {
                        var rowcount = 0
                        rowcount = index.toString().split(',')
                        if (rowcount.length > 0) {

                            var myenddate = $("#txtEnddatepolicyplan").val();
                            $.confirm({
                                title: '',
                                content: 'Do you want to update for all grades in this rule ? ',
                                theme: 'modern',
                                buttons: {
                                    All: function () {
                                       
                                        for (var i = 0; i < rowcount.length; i++) {
                                            table.cell(rowcount[i], 4).data(myenddate).draw();
                                        }
                                        myenddate = "";
                                        $.alert("Successfully updated row in table !");

                                    },
                                    One: function () {
                                        table.cell(rowindex, 4).data(myenddate).draw();
                                        myenddate = "";
                                        $.alert('Successfully updated row in table !');
                                    },
                                     cancel: function () {

                                    }

                                }
                            });

                            //if (_tablerowupdate() == true) {

                            //    for (var i = 0; i < rowcount.length; i++) {
                            //        table.cell(rowcount[i], 4).data($("#txtEnddatepolicyplan").val()).draw();
                            //    }
                            //} else {
                            //    table.cell(rowindex, 4).data($("#txtEnddatepolicyplan").val()).draw();
                            //}
                        }
                    });
                    currentRow = null;
                    $("#hiddenrowindex").val('');
                    $("#hiddenrowenddate").val("");


                } else {
                    alert("End Date can't be blank !");
                }
            } else {
                alert("Successfully added row in table !");
            }
            $("#hiddenrowgroup").val(parseInt($("#hiddenrowgroup").val()) + 1);
            clearText();
        });

        $(document).on('click', '.btnEdit', function (e) {

            if ($("#txtEffectiveEndDate").val() == "") {
                var dtnew = new Date();
                var datefrom = new Date(myDateFormatter(dtnew));
                datefrom.setDate(datefrom.getDate() + 1);
                $('#txtEnddatepolicyplan').datepicker("destroy");
                $('#txtEnddatepolicyplan').datepicker({
                    dateFormat: "dd-M-yy", closeText: 'Clear', showButtonPanel: true, changeMonth: true, minDate: new Date(datefrom), onClose: function () {
                        //var event = arguments.callee.caller.caller.arguments[0];
                        //if ($(event.delegateTarget).hasClass('ui-datepicker-close')) {
                        //    $(this).val('');
                        //}
                    }
                }).attr('readonly', true).css('background-color', 'White');
            }


            var Employeetype = $(this).closest('tr').find('td').eq(6).attr('data_id');
            var grade = $(this).closest('tr').find('td').eq(0).html().trim();
            var table = $("#tblCreatePlan tbody").find('tr');
            var enddate = $(this).closest('tr').find('td').eq(4).text().trim();
            $("#hiddenrowenddate").val($(this).closest('tr').find('td').eq(4).text().trim());
            var max_date = "";
                    table.each(function () {
                        if ($(this).find('td')) {
                            if ($(this).find("td").eq(0).html().trim() == grade && ($(this).find("td").eq(6).attr('data_id') == Employeetype) && ($(this).find("td").eq(7).html().trim() == 'Active')) {
                                if (max_date == "") {
                                    max_date = myDateFormatter($(this).find("td").eq(4).text().trim());
                                } else {
                                    if (myDateFormatter($(this).find("td").eq(4).text().trim()) > max_date) {
                                        max_date = myDateFormatter($(this).find("td").eq(4).text().trim() == "" ? "31-Dec-2099" : $(this).find("td").eq(4).text().trim());
                                    }
                                }
                            }
                        }
                    });
                    if (enddate == "") {
                        $("#txtEnddatepolicyplan").prop('disabled', false).css('background-color','#ffffff');
                    }else{
                        if (max_date != "" && max_date == "2099/12/31") {
                            $("#txtEnddatepolicyplan").prop('disabled', true).css('background-color', '#eee');
                        } else {
                            $("#txtEnddatepolicyplan").prop('disabled', false).css('background-color', '#ffffff');
                        }
                    }

            $('#btnreset').hide();
            $('#btnAddCreateRule').prop('disabled', false);
            var table = $("#tblCreatePlan tbody").find('tr');
            readonly();
            var $tr = $(this).closest('tr');
            var myRow = $tr.index(); myRow
            $("#hiddenrowindex").val($tr.index());
            currentRow = $(this).parents('tr');
            $("#ddlgrade").multiselect('select',[$(this).closest('tr').find('td').eq(0).attr('data_id')]);
            $("#txtnoofdays").val($(this).closest('tr').find('td').eq(1).html().trim());
            $("#ddlUOM ").val($(this).closest('tr').find('td').eq(2).attr('data_id').trim());
            $("#txtStartdatepolicyplan").val($(this).closest('tr').find('td').eq(3).html().trim());
            $("#txtEnddatepolicyplan").val($(this).closest('tr').find('td').eq(4).html().trim());
            $("#ddlislossofpay").val($(this).closest('tr').find('td').eq(5).attr('data_id').trim());
            $("#Employeetype").val($(this).closest('tr').find('td').eq(6).attr('data_id').trim());
            $("#ddlcreaterulestatus").val($(this).closest('tr').find('td').eq(7).attr('data_id').trim());

            $("#btnAddCreateRule").val('Update');
            $("#createrulehedding").text('Edit Rule');
            //  $("#btnreset").hide();
            $('#Create_Plan').modal('show');
        });

        $("#btn-create-plan-close").click(function () {
            $("#ddlgrade").multiselect('enable');
            $('.multiselect').css('background', '#ffffff');
            $("#txtnoofdays").val('').prop('readonly', false);
            $("#txtEnddatepolicyplan").val('').prop('readonly', false);
            $("#ddlUOM").val(0).prop('disabled', false);
            $("#txtStartdatepolicyplan").val('').prop('disabled', false).css("background-color", 'white');
            $("#btnAddCreateRule").val('Submit');
            $("#createrulehedding").text('Create Rule');
            $("#ddlislossofpay").val(0).prop("disabled", false);
            $("#Employeetype").val('0').prop("disabled", false);
            $("#ddlcreaterulestatus").val('0').prop("disabled", false);
            $("#btnreset").show();
            currentRow = null;

        });

        $('#txtEffectiveStartDate').on('change', function () {
            $('#txtEffectiveEndDate').val('');
            var tbody = $("#tblCreatePlan tbody");
            //if (tbody.children().length > 1) {
            if (table.data().count() > 0) {
                $.confirm({
                    title: 'Confirm!',
                    content: 'Data Lost',
                    theme: 'modern',
                    buttons: {
                        confirm: function () {
                            $("select.is_informationonlyenable").val('0');
                            $("input[type='text'].is_informationonlyenable").val('0').prop('disabled', true);
                            $("input[type='checkbox'].is_informationonlyenable").prop('checked', false);
                            table.rows().remove().draw();
                        },
                        cancel: function () {
                            $('#txtEffectiveStartDate').val($('#hiddeneffectivestartdate').val());
                            $('#txtEffectiveEndDate').val($('#hiddeneffectiveenddate').val());
                        }
                    }
                });
            }
            var datefrom = new Date(myDateFormatter($('#txtEffectiveStartDate').val()));
            var dateto = new Date(myDateFormatter($('#txtEffectiveEndDate').val()));
            $('#txtEffectiveEndDate').datepicker("destroy");
           datefrom.setDate(datefrom.getDate() + 1);
            $('#txtEffectiveEndDate').datepicker({
                dateFormat: "dd-M-yy", closeText: 'Clear', showButtonPanel: true, changeMonth: true, minDate: new Date(datefrom), maxDate: new Date(dateto), onClose: function () {
                    var event = arguments.callee.caller.caller.arguments[0];
                    // If "Clear" gets clicked, then really clear it
                    if ($(event.delegateTarget).hasClass('ui-datepicker-close')) {
                        $(this).val('');
                    }
                }
            }).attr('readonly', true).css('background-color', 'White');



        });

        $('#txtEffectiveEndDate').on('change', function () {
            var start_dt = myDateFormatter($('#txtEffectiveStartDate').val());
            var end_dt = myDateFormatter($('#txtEffectiveEndDate').val());
            if (start_dt > end_dt) {
                alert("End Date can't less then start date.");
                $('#txtEffectiveEndDate').val("");
                setTimeout(function () { $('#txtEffectiveEndDate').focus(); })
            }
            var tbody = $("#tblCreatePlan tbody");
            if (table.data().count() > 0) {
                var maxdate = "";
                var startmaxdate = "";
                var table1 = $("#tblCreatePlan tbody").find('tr');
                table1.each(function (i) {
                    if (maxdate == "") {
                        maxdate = myDateFormatter($(this).find("td").eq(4).text().trim() == "" ? "31-Dec-2099" : $(this).find("td").eq(4).text().trim());
                        startmaxdate = myDateFormatter($(this).find("td").eq(3).text().trim());
                    } else {
                        if (myDateFormatter($(this).find("td").eq(4).text().trim()) > maxdate) {
                            maxdate = myDateFormatter($(this).find("td").eq(4).text().trim() == "" ? "31-Dec-2099" : $(this).find("td").eq(4).text().trim());
                        }
                        if (myDateFormatter($(this).find("td").eq(3).text().trim()) > startmaxdate) {
                            startmaxdate = myDateFormatter($(this).find("td").eq(3).text().trim() == "" ? "31-Dec-2099" : $(this).find("td").eq(3).text().trim());
                        }
                    }

                });

                if (maxdate == "2099/12/31") {
                    if (end_dt <= startmaxdate) {
                        $.confirm({
                            title: 'Confirm!',
                            content: 'Data Lost',
                            theme: 'modern',
                            buttons: {
                                confirm: function () {
                                    $("select.is_informationonlyenable").val('0');
                                    $("input[type='text'].is_informationonlyenable").val('0').prop('disabled', true);
                                    $("input[type='checkbox'].is_informationonlyenable").prop('checked', false);
                                    table.rows().remove().draw();
                                },
                                cancel: function () {
                                    $('#txtEffectiveEndDate').val($('#hiddeneffectiveenddate').val());
                                }
                            }
                        });
                    }
                } else {
                    if (end_dt<=maxdate) {
                        $.confirm({
                            title: 'Confirm!',
                            content: 'Data Lost',
                            theme: 'modern',
                            buttons: {
                                confirm: function () {
                                    $("select.is_informationonlyenable").val('0');
                                    $("input[type='text'].is_informationonlyenable").val('0').prop('disabled', true);
                                    $("input[type='checkbox'].is_informationonlyenable").prop('checked', false);
                                    table.rows().remove().draw();
                                },
                                cancel: function () {
                                    $('#txtEffectiveEndDate').val($('#hiddeneffectiveenddate').val());
                                }
                            }
                        });
                    }
                }
            }
            var dt = new Date();
            var currentdate = new Date(myDateFormatter(dt));
            $('#txtStartdatepolicyplan').datepicker("destroy");
            $('#txtStartdatepolicyplan').datepicker({ dateFormat: "dd-M-yy", changeMonth: true, minDate: new Date(start_dt), maxDate: new Date(end_dt) }).attr('readonly', true).css('background-color', 'White');
            $('#txtEnddatepolicyplan').datepicker("destroy");
            $('#txtEnddatepolicyplan').datepicker({ dateFormat: "dd-M-yy", changeMonth: true, minDate: new Date(start_dt), maxDate: new Date(end_dt) }).attr('readonly', true).css('background-color', 'White');

        });

        $('#chkIsInformationOnly').on('change', function () {
            if ($(this).is(":checked") == true) {
                $("#tblCreatePlan_filter").css("display", "none");
                if (table.data().count() > 0) {

                    $.confirm({
                        title: 'Confirm!',
                        content: 'Data Lost',
                        theme: 'modern',
                        buttons: {
                            confirm: function () {
                                $("select.is_informationonlyenable").val('0');
                                $("input[type='text'].is_informationonlyenable").val('0').prop('disabled', true);
                                $("input[type='checkbox'].is_informationonlyenable").prop('checked', false);
                                table.rows().remove().draw();

                            },
                            cancel: function () {
                                $('#chkIsInformationOnly').prop('checked', false);
                                $("#tblCreatePlan_filter").css("display", "block");

                            }
                        }
                    });
                }
            }
            else {
                $("#tblCreatePlan_filter").css("display", "block");
            }
        });

        $('#ddlgrade').on('change', function () {
            $("#txtStartdatepolicyplan").val('');
        })

        $('#txtStartdatepolicyplan').on('change', function () {
            $('#txtEnddatepolicyplan').val('');
            if ($('#Employeetype').is(':disabled') == false) {
                $('#Employeetype').val('0');
            }
        });
        $('#txtEnddatepolicyplan').on('change', function () {

            var start_dt = myDateFormatter($('#txtStartdatepolicyplan').val());
            var end_dt = myDateFormatter($('#txtEnddatepolicyplan').val());
            if (start_dt > end_dt) {
                alert("End Date can't less then start date.");
                $('#txtEnddatepolicyplan').val("");
                setTimeout(function () { $('#txtEnddatepolicyplan').focus(); })
            }
        });

        $('#ddlLeaveType').on('change', function (e) {
            var ID = $(this).val();

            if (ID == "2") {
                $('#chkcanbeclubbedwithcl').removeClass('is_informationonlyenable').attr('disabled', 'disabled');
                $('#chkyeaeclubbed').addClass("is_informationonlyenable");
            }
            else if (ID == "3") {
                $('#chkyeaeclubbed').removeClass('is_informationonlyenable').attr('disabled', 'disabled');
                $('#chkcanbeclubbedwithcl').addClass('is_informationonlyenable');
            }
            else {
                $('#chkcanbeclubbedwithcl').addClass('is_informationonlyenable');
                $('#chkyeaeclubbed').addClass("is_informationonlyenable");
            }
        });

        $(document).on('click', '.fa-trash-o', function (e) {
            if (_functiondelete() == true) {
                if (_functiondeleteall() == true) {
                    table.rows('.' + $(this).closest('tr').attr('data_id')).remove().draw();
                } else {
                    table.row($(this).parents('tr')).remove().draw();
                }
            }

        });
        $("#Employeetype").on("change", function () {
            var ddlgrade = [];
            ddlgrade = $("#ddlgrade").val();
            var max_date = "";
            var min_date = "";
            var Employeetype = $(this).val();
            var table = $("#tblCreatePlan tbody").find('tr');
            if (ddlgrade.length > 0) {
                var star_date = $('#txtStartdatepolicyplan').val();
                //  $('#txtEnddatepolicyplan').datepicker("destroy");
                for (var i = 0; i < ddlgrade.length; i++) {
                    table.each(function () {
                        if ($(this).find('td')) {
                            if (Employeetype == 'A') {
                                if ($(this).find("td").eq(0).attr('data_id') == ddlgrade[i] && ($(this).find("td").eq(6).attr('data_id') == 'A') && ($(this).find("td").eq(7).html().trim() == 'Active')) {
                                   
                                    if (max_date == "") {
                                        max_date = myDateFormatter($(this).find("td").eq(4).text().trim() == "" ? "31-Dec-2099" : $(this).find("td").eq(4).text().trim());
                                        min_date = myDateFormatter($(this).find("td").eq(3).text().trim());
                                    } else {
                                        if (myDateFormatter($(this).find("td").eq(4).text().trim()) > max_date) {
                                            max_date = myDateFormatter($(this).find("td").eq(4).text().trim() == "" ? "31-Dec-2099" : $(this).find("td").eq(4).text().trim());
                                        }
                                    }
                                }
                            }
                            if (Employeetype == 'A' || Employeetype == 'N' || Employeetype == 'P' || Employeetype == 'R' || Employeetype == 'C')
                            {
                                if ($(this).find("td").eq(0).attr('data_id') == ddlgrade[i] && ($(this).find("td").eq(6).attr('data_id') == 'A') && ($(this).find("td").eq(7).html().trim() == 'Active'))
                                {
                                    if (max_date == "") {
                                        max_date = myDateFormatter($(this).find("td").eq(4).text().trim() == "" ? "31-Dec-2099" : $(this).find("td").eq(4).text().trim());
                                        min_date = myDateFormatter($(this).find("td").eq(3).text().trim());
                                    } else {
                                        if (myDateFormatter($(this).find("td").eq(4).text().trim()) > max_date) {
                                            max_date = myDateFormatter($(this).find("td").eq(4).text().trim() == "" ? "31-Dec-2099" : $(this).find("td").eq(4).text().trim());
                                        }
                                    }
                                } else {
                                    if ($(this).find("td").eq(0).attr('data_id') == ddlgrade[i] && ($(this).find("td").eq(6).attr('data_id') == Employeetype || Employeetype=="A") && ($(this).find("td").eq(7).html().trim() == 'Active')) {
                                        if (max_date == "") {
                                            max_date = myDateFormatter($(this).find("td").eq(4).text().trim() == "" ? "31-Dec-2099" : $(this).find("td").eq(4).text().trim());
                                            min_date = myDateFormatter($(this).find("td").eq(3).text().trim());
                                        } else {
                                            if (myDateFormatter($(this).find("td").eq(4).text().trim()) > max_date) {
                                                max_date = myDateFormatter($(this).find("td").eq(4).text().trim() == "" ? "31-Dec-2099" : $(this).find("td").eq(4).text().trim());
                                            }
                                        }
                                    }

                                }
                            }
                        }
                    });
                }
            }
            if (min_date != "") {
                if (max_date != "" && max_date >= myDateFormatter($('#txtStartdatepolicyplan').val().trim())) {
                    alert('You have already create policy rule of this date !');
                    $('#txtStartdatepolicyplan').val('').focus();
                    $('#Employeetype').val('0');
                } else if (max_date =="NaN/NaN/NaN") {
                    alert('You have already create policy rule of this date !');
                    $('#txtStartdatepolicyplan').val('').focus();
                    $('#Employeetype').val('0');
                }
            }
        });
    });

    function readonly() {
        $("#ddlgrade").multiselect('disable');
        $('.multiselect').css('background', '#eee');
        $("#txtnoofdays").prop("readOnly", true);
        $("#ddlUOM").prop("disabled", true);
        $("#txtStartdatepolicyplan").prop("disabled", true).css("background-color", '#eee');
        $("#ddlislossofpay").prop("disabled", true);
        $("#Employeetype").prop('disabled', true);
        $("#ddlcreaterulestatus").prop('disabled', true);
    }

    function readonlyfalse() {

        $("#ddlgrade").multiselect('enable');
        $('.multiselect').css('background', '#ffffff');
        $("#txtnoofdays").prop("readOnly", false);
        $("#ddlUOM").prop("disabled", false);
        $("#ddlislossofpay").prop("disabled", false);
        $("#txtStartdatepolicyplan").prop('disabled', false).css("background-color", 'white');
        $("#Employeetype").prop('disabled', false);
        $("#ddlcreaterulestatus").prop('disabled', false);
    }

    function clearText() {
        if (currentRow != null) {
            $('#txtEnddatepolicyplan').val('');
        } else {
            $('#ddlgrade').multiselect('clearSelection');
            $("#ddlgrade").val(0);
            $("#txtnoofdays").val('');
            $("#txtEnddatepolicyplan").val('');
            $("#ddlUOM").val(0);
            $("#txtStartdatepolicyplan").val('');
            $("#ddlislossofpay").val(0);
            $("#Employeetype").val('0');
            $("#ddlcreaterulestatus").val('0');
        }
    }
</script>
<script>

    function StepOne() {

        var leavepolicy = {};
        leavepolicy.LeaveTypeID = $("#ddlLeaveType  option:selected ").val();
        leavepolicy.PolicyName = $("#txtPolicyname").val();
        leavepolicy.PolicyDescription = $("#txtDesc").val();
        leavepolicy.StartDate = $("#txtEffectiveStartDate ").val();
        leavepolicy.EndDate = $("#txtEffectiveEndDate ").val();
        leavepolicy.Status = $("#ddlStatus  option:selected").text();
        leavepolicy.IsInformationOnly = $("#chkIsInformationOnly").is(':checked') == true ? 1 : 0;
        $.ajax({
            type: 'POST',
            url: '/leave/leavepolicystepone',
            contentType: 'application/json;charset=utf-8',
            data: JSON.stringify({ leavepolicy }),
            dataType: 'json'
        });
        var contentDiv = $("#DivLeavePolicy");
        contentDiv.empty();
        var MisReview = "";
        MisReview += "<h4>Leave Policy</h4>";
        MisReview += " <div class='row'><span class='col-sm-3'>Leave Type </span>  <div class='col-sm-9'> <div id='lblLeaveType' class='cmplitetextalign' >" + $("#ddlLeaveType  option:selected ").text() + "</div></div> </div>";
        MisReview += " <div class='row'><span class='col-sm-3'>Policy Name </span>  <div class='col-sm-9'><div id='lblPolicyName' class='cmplitetextalign' >" + $("#txtPolicyname ").val() + "</div></div> </div>";
        MisReview += " <div class='row'><span class='col-sm-3'>Policy Description  </span>  <div class='col-sm-9'> <span id='lblDesc'  class='cmplitetextalign'>" + $("#txtDesc").val() + "</span></div> </div>";
        MisReview += " <div class='row'><span class='col-sm-3'>Start Date </span>  <div class='col-sm-9'> <div id='lblEffectiveStartDate' class='cmplitetextalign' >" + $("#txtEffectiveStartDate").val() + "</div></div> </div>";
        MisReview += " <div class='row'><span class='col-sm-3'>End Date</span>  <div class='col-sm-9'> <div id='lblEffectiveEndDate'  class='cmplitetextalign'>" + $("#txtEffectiveEndDate").val() + "</div></div> </div>";
        MisReview += " <div class='row'><span class='col-sm-3'>Status</span>  <div class='col-sm-9'> <div id='lblEffectiveEndDate' class='cmplitetextalign'>" + $("#ddlStatus  option:selected").text() + "</div></div> </div>";
        if ($("#chkIsInformationOnly").is(':checked') == true) {
            MisReview += " <div class='row'><span class='col-sm-3'>Is Information Only  </span>  <div class='col-sm-9'> <div id='lblLeaveType' ><input type='checkbox' checked disabled class='form- check - input'></div></div> </div>";

        } else {
            MisReview += " <div class='row'><span class='col-sm-3'>Is Information Only  </span>  <div class='col-sm-9'> <div id='lblLeaveType' ><input type='checkbox' disabled class='form- check - input'></div></div> </div>";
        }
        contentDiv.append(MisReview);
    }

    function StepOnePrevious() {

        $('#hiddeneffectivestartdate').val($('#txtEffectiveStartDate').val());
        $('#hiddeneffectiveenddate').val($('#txtEffectiveEndDate').val());
        var maxdate = "";
        var table = $("#tblCreatePlan tbody").find('tr');
        table.each(function (i) {
            if ($(this).find("td").eq(4).text().trim() != "") {

                if (maxdate == "") {
                    maxdate = myDateFormatter($(this).find("td").eq(4).text().trim());
                } else {
                    if (myDateFormatter($(this).find("td").eq(4).text().trim()) > maxdate) {
                        maxdate = myDateFormatter($(this).find("td").eq(4).text().trim());
                    }
                }
            }

        });
        var dt = new Date();
        var currentdate = new Date(myDateFormatter(dt));
        var startdate = new Date(myDateFormatter($('#txtEffectiveStartDate').val()));
        startdate.setDate(startdate.getDate() + 1);
        //if (maxdate != "" && $('#txtEffectiveEndDate').val() == "") {
        //    $('#txtEffectiveEndDate').datepicker("destroy");
        //    $('#txtEffectiveEndDate').datepicker({
        //        dateFormat: "dd-M-yy", closeText: 'Clear', showButtonPanel: true, changeMonth: true, minDate: new Date(myDateFormatter(currentdate)), maxDate: new Date(myDateFormatter(new Date(maxdate))) ,onClose: function () {
        //            var event = arguments.callee.caller.caller.arguments[0];
        //            // If "Clear" gets clicked, then really clear it
        //            if ($(event.delegateTarget).hasClass('ui-datepicker-close')) {
        //                $(this).val('');
        //            }
        //        }
        //    }).attr('readonly', true).css('background-color', 'White');
        //}
        //else {
        //    $('#txtEffectiveEndDate').datepicker("destroy");
        //    $('#txtEffectiveEndDate').datepicker({
        //        dateFormat: "dd-M-yy", closeText: 'Clear', showButtonPanel: true, changeMonth: true, minDate: new Date(myDateFormatter(startdate)), onClose: function () {
        //            var event = arguments.callee.caller.caller.arguments[0];
        //            // If "Clear" gets clicked, then really clear it
        //            if ($(event.delegateTarget).hasClass('ui-datepicker-close')) {
        //                $(this).val('');
        //            }
        //        }
        //    }).attr('readonly', true).css('background-color', 'White');
        //}

        $('#txtEffectiveEndDate').datepicker("destroy");
            $('#txtEffectiveEndDate').datepicker({
                dateFormat: "dd-M-yy", closeText: 'Clear', showButtonPanel: true, changeMonth: true, minDate: new Date(myDateFormatter(startdate)), onClose: function () {
                    var event = arguments.callee.caller.caller.arguments[0];
                    // If "Clear" gets clicked, then really clear it
                    if ($(event.delegateTarget).hasClass('ui-datepicker-close')) {
                        $(this).val('');
                    }
                }
            }).attr('readonly', true).css('background-color', 'White');
        $("#ddlLeaveType option:selected ").val(0);
        $("#txtPolicyname").val('');
        $("#txtDesc").val('');
        $("#txtEffectiveStartDate").val('');
        $("#txtEffectiveEndDate").val('');
        $("#ddlStatus option:selected ").val(0);

        $("#chkIsInformationOnly").prop('checked', false);

        $.ajax({

            type: 'POST',
            url: '/leave/leavepolicysteponeprevious',
            contentType: 'application/json;charset=utf-8',
            data: {},
            dataType: 'json',
            success: function (response) {
                if (response != null) {
                    $("#ddlLeaveType  option:selected ").val(response.LeaveTypeID);
                    $("#txtPolicyname ").val(response.PolicyName);
                    $("#txtDesc").val(response.PolicyDescription);
                    $("#txtEffectiveStartDate").val(response.StartDate);
                    $("#txtEffectiveEndDate").val(response.EndDate);
                    $("#ddlStatus option:selected").val(response.Status);
                    if (response.IsInformationOnly == 1) {
                        $("#chkIsInformationOnly").prop('checked', true);
                    } else {
                        $("#chkIsInformationOnly").prop('checked', false);
                    }

                }
            }

        });

    }

    function StepTwo() {
        if ($('#ddlLeaveType').val() == '3') {
            $('#chkcarrayforwardyear').prop("disabled", true).prop('checked', false);
        } else {
            $('#chkcarrayforwardyear').prop("disabled", false);
        }
        var data = [];
        var tablebody = $("#tblCreatePlan tbody");

        tablebody.find('tr').each(function (i) {
            var mydata = $("#tblCreatePlan").DataTable();
            if (mydata.data().count() > 0) {
                var row_class = $(this).attr('data_id');
                var Grade = $(this).find("td").eq(0).html();
                var GradeID = $(this).find("td").eq(0).attr('data_id');
                var NoOfDays = $(this).find("td").eq(1).html();
                var UOM = $(this).find("td").eq(2).html();
                var UOMID = $(this).find("td").eq(2).attr('data_id');
                var StartDate = $(this).find("td").eq(3).html();
                var EndDate = $(this).find("td").eq(4).html();
                var IslossofPay = $(this).find("td").eq(5).html();
                var Employee_Type = $(this).find("td").eq(6).html();
                var Plan_Status = $(this).find("td").eq(7).attr('data_id');
                var alldata = {
                    'Grade': Grade,
                    'GradeID': GradeID,
                    'NoOfDays': NoOfDays,
                    'UOM': UOM,
                    'UOMID': UOMID,
                    'StartDate': StartDate,
                    'EndDate': EndDate,
                    'IslossofPay': IslossofPay,
                    'Employer_Type': Employee_Type.trim(),
                    'Plan_Status': Plan_Status,
                    'row_class': row_class
                }
                data.push(alldata);
            }
         });

        var leaveplan = {};
        leaveplan.AttachmentRequired = $("#chkAttachmentRequired").is(':checked') == true ? 1 : 0;
        leaveplan.Gender = $("#ddlGender").val();
        leaveplan.LeaveYear = $("#ddlLeaveYear  option:selected").text();
        leaveplan.CreditFrequency = $("#ddPeriod  option:selected").text();
        leaveplan.Credit = $("#ddlCredit  option:selected").text();
        leaveplan.IncludePublicHolidays = $("#chkincludepublicholidays").is(':checked') == true ? 1 : 0;
        leaveplan.IncludeWeekends = $("#chkincludeweekends").is(':checked') == true ? 1 : 0;
        leaveplan.CanbeclubbedwithEL = $("#chkyeaeclubbed").is(':checked') == true ? 1 : 0;
        leaveplan.CanbeclubbedwithCL = $("#chkcanbeclubbedwithcl").is(':checked') == true ? 1 : 0;
        leaveplan.Canbehalfday = $("#chkcanbehalfday").is(':checked') == true ? 1 : 0;
        leaveplan.Notice_Period_P = $("#chkavailnoticeperiad").is(':checked') == true ? 1 : 0;
        leaveplan.Probation_Period_P = $("#chkavailprobationperiad").is(':checked') == true ? 1 : 0;
        leaveplan.Confirmed_P = $("#chkavailregular").is(':checked') == true ? 1 : 0;
        leaveplan.Contract_Period_P = $("#chkavailcontract").is(':checked') == true ? 1 : 0;
        leaveplan.tblCreateRule = data;
        $.ajax({
            type: 'POST',
            url: '/leave/leaveplansteptwo',
            contentType: 'application/json;charset=utf-8',
            data: JSON.stringify({ leaveplan }),
            dataType: 'json'
        });

        var contentDiv = $("#DivLeavePlan");
        contentDiv.empty();
        var MisReview = "";
        MisReview += "<h4>Leave Plan</h4>";
        if ($("#chkAttachmentRequired").is(':checked') == true) {
            MisReview += " <div class='row'><span class='col-sm-3'>Attachment Required  </span>  <div class='col-sm-9'> <div id='lblLeaveType' ><input type='checkbox' checked disabled class='form- check - input'></div></div> </div>";

        } else {
            MisReview += " <div class='row'><span class='col-sm-3'>Attachment Required  </span>  <div class='col-sm-9'> <div id='lblLeaveType' ><input type='checkbox' disabled class='form- check - input'></div></div> </div>";
        }
        MisReview += " <div class='row'><span class='col-sm-3'>Gender </span>  <div class='col-sm-9'> <div id='lblLeaveType' class='cmplitetextalign' >" + $("#ddlGender  option:selected ").text() + "</div></div> </div>";
        MisReview += " <div class='row'><span class='col-sm-3'>Leave Year </span>  <div class='col-sm-9'> <div id='lblLeaveYear' class='cmplitetextalign' >" + $("#ddlLeaveYear  option:selected ").text() + "</div></div> </div>";

        MisReview += " <div class='row'><span class='col-sm-3'>Credit Frequency </span>  <div class='col-sm-9'> <div id='lblCreditFrequency' class='cmplitetextalign' >" + $("#ddPeriod  option:selected ").text() + "</div></div> </div>";
        MisReview += " <div class='row'><span class='col-sm-3'>Credit </span>  <div class='col-sm-9'> <div id='lblCredit' class='cmplitetextalign' >" + $("#ddlCredit  option:selected ").text() + "</div></div> </div>";
        MisReview += " <div class='row'><span class='col-sm-3'>Leave Limits </span>  <div class='col-sm-9'>";
        if ($("#chkincludepublicholidays").is(':checked') == true) {
            MisReview += "<input type='checkbox' id='chkIncludePublicHolidaysreview' checked disabled class='form-check-input'> Include Public Holidays </br>";
        } else {
            MisReview += "<input type='checkbox' id='chkIncludePublicHolidaysreview' disabled class='form-check-input'>  Include Public Holidays </br>";
        }

        if ($("#chkincludeweekends").is(':checked') == true) {
            MisReview += "   <input type='checkbox' id='chkIncludeWeekendsreview' checked disabled class='form-check-input'> Include Weekends </br>";
        } else {
            MisReview += "   <input type='checkbox' id='chkIncludeWeekendsreview' disabled class='form-check-input'>  Include Weekends </br> ";
        }
        if ($("#chkyeaeclubbed").is(':checked') == true) {
            MisReview += "   <input type='checkbox' id='chkyeaeclubbed' checked disabled class='form-check-input'> Can be clubbed with EL </br>";
        } else {
            MisReview += "   <input type='checkbox' id='chkyeaeclubbed' disabled class='form-check-input'> Can be clubbed with EL </br> ";
        }
        if ($("#chkcanbeclubbedwithcl").is(':checked') == true) {
            MisReview += "   <input type='checkbox' id='chkyeaeclubbed' checked disabled class='form-check-input'> Can be clubbed with CL </br>";
        } else {
            MisReview += "   <input type='checkbox' id='chkyeaeclubbed' disabled class='form-check-input'> Can be clubbed with CL </br> ";
        }
        if ($("#chkcanbehalfday").is(':checked') == true) {
            MisReview += "   <input type='checkbox' id='chkcanbehalfday' checked disabled class='form-check-input'> Can be half day</br>";
        } else {
            MisReview += "   <input type='checkbox' id='chkcanbehalfday' disabled class='form-check-input'> Can be half day</br> ";
        }
        MisReview += "  </div> </div>";
        MisReview += " </br><div class='row'><span class='col-sm-3'>Can Avail In </span>  <div class='col-sm-9'>";
        if ($("#chkavailprobationperiad").is(':checked') == true) {
            MisReview += "   <input type='checkbox' id='chkavailprobationperiad' checked disabled class='form-check-input'> Probation Period</br>";
        } else {
            MisReview += "   <input type='checkbox' id='chkavailprobationperiad' disabled class='form-check-input'> Probation Period</br> ";
        }

        if ($("#chkavailregular").is(':checked') == true) {
            MisReview += "   <input type='checkbox' id='chkavailregular' checked disabled class='form-check-input'> Regular Period</br>";
        } else {
            MisReview += "   <input type='checkbox' id='chkavailregular' disabled class='form-check-input'> Regular Period</br> ";
        }

        if ($("#chkavailcontract").is(':checked') == true) {
            MisReview += "   <input type='checkbox' id='chkavailcontract' checked disabled class='form-check-input'> Contract Period</br>";
        } else {
            MisReview += "   <input type='checkbox' id='chkavailcontract' disabled class='form-check-input'> Contract Period</br> ";
        }

        if ($("#chkavailnoticeperiad").is(':checked') == true) {
            MisReview += "   <input type='checkbox' id='chkavailnoticeperiad' checked disabled class='form-check-input'> Notice Period</br>";
        } else {
            MisReview += "   <input type='checkbox' id='chkavailnoticeperiad' disabled class='form-check-input'> Notice Period</br> ";
        }

        MisReview += "  </div> </div>";
        MisReview += "</br> <div class='row'><div class='col-sm-3'> </div>  <div class='col-sm-9'> <table  class='table table-striped custom-table m-b-0 datatable'><tr> <td>Grade</td><td>Duration</td><td>UOM</td><td>Start Date</td> <td>End Date</td> <td> Is loss of Pay  </td>  <td> Employment Type  </td> <td> Status </td> </tr>";
        var table = $("#tblCreatePlan tbody").find('tr');
        var mydata = $("#tblCreatePlan").DataTable();
        if (mydata.data().count() > 0) {
            table.each(function (i) {
                if ($(this).find('td')) {
                    MisReview += "<tr><td>" + $(this).find('td').eq(0).html() + "</td><td>" + $(this).find('td').eq(1).html() + "</td><td>" + $(this).find('td').eq(2).html() + "</td><td>" + $(this).find('td').eq(3).html() + "</td><td>" + $(this).find('td').eq(4).html() + "</td><td>" + $(this).find('td').eq(5).html() + "</td> <td>" + $(this).find('td').eq(6).html() + "</td> <td>" + $(this).find('td').eq(7).html() + "</td>  </tr>";
                }
            });
        }


        MisReview += "</table> </br></div> </div>";

        contentDiv.append(MisReview);

    }

    function StepTwoPrevious() {

        $("#chkAttachmentRequired").prop('checked', false);
        $("#ddlGender").val("0");
        $("#ddlLeaveYear").val("0");
        $("#ddPeriod").val("0");
        $("#ddlCredit").val("0");
        $("#chkincludepublicholidays").prop('checked', false);
        $("#chkincludeweekends").prop('checked', false);
        $("#chkyeaeclubbed").prop('checked', false);
        $("#chkcanbeclubbedwithcl").prop('checked', false);
        $("#chkcanbehalfday").prop('checked', false);
        $("#chkavailprobationperiad").prop('checked', false);
        $("#chkavailregular").prop('checked', false);
        $("#chkavailcontract").prop('checked', false);
        $("#chkavailnoticeperiad").prop('checked', false);

        $("#tblCreatePlan tbody").find('tr').remove();
        $.ajax({
            type: 'POST',
            url: '/leave/leaveplansteptwoprevious',
            contentType: 'application/json;charset=utf-8',
            data: {},
            dataType: 'json',
            success: function (response) {
                if (response != null) {

                    $("#chkAttachmentRequired").prop('checked', response.AttachmentRequired == 1 ? true : false);
                    $("#ddlGender").val(response.Gender == 'Select' ? 0 : response.Gender);
                    $("#ddlLeaveYear").val(response.LeaveYear == 'Select' ? 0 : response.LeaveYear);
                    $("#ddPeriod").val(response.CreditFrequency == 'Select' ? 0 : response.CreditFrequency);
                    $("#ddlCredit").val(response.Credit == 'Select' ? 0 : response.Credit);
                    $("#chkincludepublicholidays").prop('checked', response.IncludePublicHolidays == 1 ? true : false);
                    $("#chkincludeweekends").prop('checked', response.IncludeWeekends == 1 ? true : false);
                    $("#chkyeaeclubbed").prop('checked', response.CanbeclubbedwithEL == 1 ? true : false);
                    $("#chkcanbeclubbedwithcl").prop('checked', response.CanbeclubbedwithCL == 1 ? true : false);
                    $("#chkcanbehalfday").prop('checked', response.Canbehalfday == 1 ? true : false);
                    $("#chkavailprobationperiad").prop('checked', response.Probation_Period_P == 1 ? true : false);
                    $("#chkavailregular").prop('checked', response.Confirmed_P == 1 ? true : false);
                    $("#chkavailcontract").prop('checked', response.Contract_Period_P == 1 ? true : false);
                    $("#chkavailnoticeperiad").prop('checked', response.Notice_Period_P == 1 ? true : false);

                    var len = Object.keys(response.tblCreateRule).length;
                    for (var i = 0; i < len; i++) {
                        var markup = "";
                        markup += "<tr  data_id='" + response.tblCreateRule[i].row_class + "' id='row'" + i + "'  class='text-center " + response.tblCreateRule[i].row_class + "'>";
                        markup += "<td  data_id='" + response.tblCreateRule[i].GradeID + "'> " + response.tblCreateRule[i].Grade + "</td > ";
                        markup += "<td> " + response.tblCreateRule[i].NoOfDays + "</td > ";
                        markup += "<td  data_id='" + response.tblCreateRule[i].UOMID + "'> " + response.tblCreateRule[i].UOM + "</td > ";
                        markup += "<td> " + response.tblCreateRule[i].StartDate + "</td > ";
                        markup += "<td> " + response.tblCreateRule[i].EndDate + "</td > ";
                        markup += "<td  data_id='" + response.tblCreateRule[i].IslossofPay + "'> " + response.tblCreateRule[i].IslossofPay + "</td > ";
                        markup += "<td  data_id='" + response.tblCreateRule[i].Employer_Type.trim().substring(0, 1) + "'> " + response.tblCreateRule[i].Employer_Type + "</td > ";
                        markup += "<td  data_id='" + response.tblCreateRule[i].Plan_Status + "'> " + response.tblCreateRule[i].Plan_Status + "</td > ";
                        markup += "<td> <a href='javascript:void(0)' class='font-18 btnEdit' title='Edit'><i class='fa fa-pencil m-r-5' aria-hidden='true'></i></a> <a href='javascript:void(0)' class='text-danger font-18 btnDelete' title='Remove'><i class='fa fa-trash-o' aria-hidden='true'></i></a></td>";
                        markup += "</tr>";
                        $("#tblCreatePlan tbody").append(markup);
                    }
                }
            }

        });



    }

    function StepFour() {

        var yearendprocessing = {};
        yearendprocessing.AllowCarryover_CarryoverLimit = $("#txtCarryoverLimit").val() == '' ? 0 : $("#txtCarryoverLimit").val();
        yearendprocessing.PayatYearend_MinBal = $("#txtPayatYearendMaxBal").val() == '' ? 0 : $("#txtPayatYearendMaxBal").val();
        yearendprocessing.PayatYearend_MaxEncashment = $("#txtMaximumEncashmentPerYear").val() == '' ? 0 : $("#txtMaximumEncashmentPerYear").val();
        yearendprocessing.EligibleForEncashment_Limit = $("#EncashmentLimit").val() == '' ? 0 : $("#EncashmentLimit").val();
        yearendprocessing.EligibleForEncashment_MinBal = $("#txteligibaleForEncashmentmaxbal").val() == '' ? 0 : $("#txteligibaleForEncashmentmaxbal").val();
        yearendprocessing.CarryForwardtoEL_CFLimit = $("#txtcarrayforyear").val() == '' ? 0 : $("#txtcarrayforyear").val();
        $.ajax({
            type: 'POST',
            url: '/leave/yearendprocessing',
            contentType: 'application/json;charset=utf-8',
            data: JSON.stringify(yearendprocessing),
            dataType: 'json',
            success: function (response) {
            }

        });


        var contentDiv = $("#DivYearEndProcessing");
        contentDiv.empty();
        var MisReview = "";
        MisReview += "<h4>Year End Processing</h4>";
        MisReview += " <div class='row'><span class='col-sm-3'>Allow Carryover </span>  <div class='col-sm-9'><div  class='cmplitetextalign'>   Carryover Limit  : <label id='lblCarryoverLimit'  class='cmplitetextalign' >" + $("#txtCarryoverLimit ").val() + "</label></div></div> </div>";
        MisReview += " <div class='row'><span class='col-sm-3'>Pay at Year end </span>  <div class='col-sm-9'> <div  class='cmplitetextalign'>     Min. Balance Need To be Maintained  : <label id='lblCarryoverLimit'  class='cmplitetextalign'>" + $("#txtPayatYearendMaxBal ").val() + "</label></div></div> </div>";
        MisReview += " <div class='row'><span class='col-sm-3'> </span>  <div class='col-sm-9'> <div  class='cmplitetextalign'>    Maximum Encashment Per Year : <label id='lblCarryoverLimit' class='cmplitetextalign' >" + $("#txtMaximumEncashmentPerYear ").val() + "</label></div></div> </div>";
        MisReview += " <div class='row' style='display:none'><span class='col-sm-3'>Eligible For Encashment</span>  <div class='col-sm-9'> <div  class='cmplitetextalign'>    Encashment Limit : <label id='lblCarryoverLimit'  class='cmplitetextalign'>" + $("#EncashmentLimit ").val() + "</label></div></div> </div>";
        MisReview += " <div class='row'><span class='col-sm-3'> </span>  <div class='col-sm-9'> <div  class='cmplitetextalign'>    Min. Balance Need To be Maintained : <label id='lblCarryoverLimit' class='cmplitetextalign' >" + $("#txteligibaleForEncashmentmaxbal ").val() + "</label></div></div> </div>";
        MisReview += " <div class='row'><span class='col-sm-3'>Carry Forward To EL </span>  <div class='col-sm-9'> <div  class='cmplitetextalign'>    Carry forward Limit: <label id='CarrayForYear' class='cmplitetextalign' >" + $("#txtcarrayforyear ").val() + "</label></div></div> </div>";

        contentDiv.append(MisReview);
    }

    function StepThreePrevious() {
        $("#txtCarryoverLimit").val('');
        $("#txtPayatYearendMaxBal").val('');
        $("#txtMaximumEncashmentPerYear").val('');
        $("#EncashmentLimit").val('');
        $("#txteligibaleForEncashmentmaxbal").val('');
        $("#txtcarrayforyear").val('');

        $.ajax({

            type: 'POST',
            url: '/leave/yearendprocessingstepthreeprevious',
            contentType: 'application/json;charset=utf-8',
            data: {},
            dataType: 'json',
            success: function (response) {
                if (response != null) {
                    $("#txtCarryoverLimit").val(response.AllowCarryover_CarryoverLimit);
                    $("#txtPayatYearendMaxBal").val(response.PayatYearend_MinBal);
                    $("#txtMaximumEncashmentPerYear").val(response.PayatYearend_MaxEncashment);
                    $("#EncashmentLimit").val(response.EligibleForEncashment_Limit);
                    $("#txteligibaleForEncashmentmaxbal").val(response.EligibleForEncashment_MinBal);
                    $("#txtcarrayforyear").val(response.CarryForwardtoEL_CFLimit);
                }
            }

        });

    }

    function _btncancel() {

        if (confirm("Are you sure you want to cancel the form ?")) {
            //document.forms["myform"].submit();
            window.location.href = "/leave/LeavePolicy_History";

        } else {
            return false;
        }
    }

    function _tablerowupdate() {

        if (confirm("Do you want to update for all grades in this rule ? ")) {
            return true;
        } else {
            return false;
        }

    }

    function _functiondelete() {

        if (confirm("Are you sure you want to delete record ?")) {
            return true;
        } else {
            return false;
        }
    }
    function _functiondeleteall() {

        if (confirm("Do you want to delete for all grades in this rule ?")) {
            return true;
        } else {
            return false;
        }
    }
</script>
<script>
    $(document).ready(function () {

        //Initialize tooltips
        $('.nav-tabs > li a[title]').tooltip();
        //Wizard
        $('a[data-toggle="tab"]').on('show.bs.tab', function (e) {
            var $target = $(e.target);
            if ($target.parent().hasClass('disabled')) {
                return false;
            }
        });
        $(".next-step").click(function (e) {
            var $active = $('.wizard .nav-tabs li.active');
            if ($(e.target).val() == "stepone") {
                if ($("#ddlLeaveType option:selected").val() == "0") {
                    alert('Please Select Leave Type !');
                    $("#ddlLeaveType").focus();
                    return false;
                }
                if ($("#txtPolicyname").val() == "") {
                    alert("Policy Name Can't be Blank !");
                    $("#txtPolicyname").focus();
                    return false;
                }
                if ($("#txtEffectiveStartDate").val() == "") {
                    alert("Start Date Can't be Blank !");
                    $("#txtEffectiveStartDate").focus();
                    return false;
                }

                if ($("#ddlStatus option:selected").val() == "0") {
                    alert('Please Select Status !');
                    $("#ddlStatus").focus();
                    return false;
                }

                if ($("#chkIsInformationOnly").is(":checked") == false) {
                    $(".is_informationonlyenable").prop('disabled', false);
                    $(".can_avail").prop('disabled', false).prop('checked', true);
                    $(".year_proccessing").prop('disabled', true).prop('checked', false);
                    $("input[type='text'].year_proccessing").val('0').prop('disabled', true);
                    $("input[type='checkbox'].year_proccessing").prop('disabled', false).prop('checked', false);

                } else {
                    $(".is_informationonlyenable").val('0').prop('disabled', true);
                    $("input[type='checkbox'].is_informationonlyenable").prop('checked', false);
                    $(".can_avail").prop('disabled', true).prop('checked', false);
                    $("input[type='text'].year_proccessing").val('0').prop('disabled', true);
                    $("input[type='checkbox'].year_proccessing").prop('disabled', true).prop('checked', false);
                    $("#tblCreatePlan").DataTable().rows().remove().draw();

                }
            }

            if ($(e.target).val() == "steptwo") {

                if ($("#chkIsInformationOnly").is(":checked") == false) {

                    if ($("#ddlGender option:selected").val() == "0") {
                        alert('Please Select Gender !');
                        $("#ddlGender").focus();
                        return false;
                    }
                    if ($("#ddlLeaveYear option:selected").val() == "0") {
                        alert('Please Select Leave Year !');
                        $("#ddlLeaveYear").focus();
                        return false;
                    }
                    if ($("#ddPeriod").val() == "0") {
                        alert("Please Select Credit Frequency ! ");
                        $("#ddPeriod").focus();
                        return false;
                    }
                    if ($("#ddlCredit").val() == "0") {
                        alert("Please Select Credit  ! ");
                        $("#ddlCredit").focus();
                        return false;
                    }
                    var mydata = $("#tblCreatePlan").DataTable();
                    if (mydata.data().count() == 0) {
                        alert("Rule can't be empty !");
                        return false;
                    }

                }


            }


            $active.next().removeClass('disabled');
            $active.removeClass('active');
            $active.addClass('disabled');
            nextTab($active);
        });
        $(".prev-step").click(function (e) {
            var $active = $('.wizard .nav-tabs li.active');
            $active.prev().removeClass('disabled');
            $active.removeClass('active');
            $active.addClass('disabled');
            prevTab($active);
        });
    });
    function nextTab(elem) {
        $(elem).next().find('a[data-toggle="tab"]').click();
    }
    function prevTab(elem) {
        $(elem).prev().find('a[data-toggle="tab"]').click();
    }
    function myDateFormatter(dateObject) {
        var d = new Date(moment(dateObject, '"DD-MMM-YYYY').format());
        var day = d.getDate();
        var month = d.getMonth() + 1;
        var year = d.getFullYear();
        if (day < 10) {
            day = "0" + day;
        }
        if (month < 10) {
            month = "0" + month;
        }
        var date = year + "/" + month + "/" + day;

        return date;
    };
</script>
<div class="row">
    <div class="col-sm-8">
        <h4 class="page-title"> Create Leave Policy</h4>
    </div>
    <div class="col-sm-4 text-right m-b-30">
    </div>
</div>
<div class="row">
    <div class="col-md-12">
        <div>
            <section>
                <div class="wizard card-box">
                    <div class="wizard-inner">
                        <div class="connecting-line"></div>
                        <!--Tab Heading-->
                        <ul class="nav nav-tabs" role="tablist">
                            <li role="presentation" class="active">
                                <a href="#step1" data-toggle="tab" aria-controls="step1" role="tab" title="Step 1">
                                    <label>Leave Policy</label>
                                </a>
                            </li>
                            <li role="presentation" class="disabled">
                                <a href="#step2" data-toggle="tab" aria-controls="step2" role="tab" title="Step 2">
                                    <label>Leave Plan</label>
                                </a>
                            </li>

                            <li role="presentation" class="disabled">
                                <a href="#step4" data-toggle="tab" aria-controls="step4" role="tab" title="Step 3">
                                    <label>Year End Processing</label>
                                </a>
                            </li>
                            <li role="presentation" class="disabled">
                                <a href="#complete" data-toggle="tab" aria-controls="complete" role="tab" title="Complete">
                                    <label>Summary</label>

                                </a>
                            </li>
                        </ul>
                    </div>
                    <form role="form">
                        <div class="tab-content">
                            <div class="tab-pane active" role="tabpanel" id="step1">
                                <div class="row">
                                    <div class="col-sm-12">
                                        <div class="form-group row">
                                            <span class="col-sm-3">Leave Type <span class="text-danger">*</span> </span>
                                            <div class="col-sm-4">
                                                @Html.DropDownList("ddlLeaveType", (IEnumerable<SelectListItem>)ViewBag.leavetypeli, new { @class = "form-control" })
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-4">
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-12">
                                        <div class="form-group row">
                                            <span class="col-sm-3 ">Policy Name <span class="text-danger">*</span> </span>
                                            <div class="col-sm-4">
                                                <input type="text" id="txtPolicyname" autocomplete="off" placeholder="Policy name" class="form-control" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-4">
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-12">
                                        <div class="form-group row">
                                            <span class="col-sm-3 ">Policy Description </span>
                                            <div class="col-sm-4">
                                                <textarea class="form-control" placeholder="Description" role="3" id="txtDesc"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-4">
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-12">
                                        <div class="form-group row">
                                            <span class="col-sm-3 ">Start Date <span class="text-danger">*</span> </span>
                                            <div class="col-sm-4">
                                                <div class="cal-icon"><input type="text" id="txtEffectiveStartDate" placeholder="dd-mmm-yyyy" class="form-control mycal" /></div>
                                                <input type="hidden" id="hiddeneffectivestartdate" name="name" value="" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-4">
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-sm-12">
                                        <div class="form-group row">
                                            <span class="col-sm-3 ">End Date </span>
                                            <div class="col-sm-4">
                                                <div class="cal-icon">
                                                    <input type="text" id="txtEffectiveEndDate" placeholder="dd-mmm-yyyy" class="form-control mycal" />
                                                    <input type="hidden" id="hiddeneffectiveenddate" name="name" value="" />
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-sm-12">
                                        <div class="form-group row">
                                            <span class="col-sm-3 ">Status <span class="text-danger">*</span></span>
                                            <div class="col-sm-4">
                                                @Html.DropDownList("ddlStatus", (IEnumerable<SelectListItem>)ViewBag.status, new { @class = "form-control" })
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-4">
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-sm-12">
                                        <div class="form-group row">
                                            <span class="col-sm-3 "> Is Information Only </span>
                                            <div class="col-sm-4 form-check">
                                                <label class="form-check-label">
                                                    <input type="checkbox" id="chkIsInformationOnly" value="1" class="form-check-input">

                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-4">
                                    </div>
                                </div>

                                <ul class="mybtncls pull-right">
                                    <li>
                                        <button type="button" id="btnStapOne" onclick="StepOne();" value="stepone" class="btn btn-primary next-step">Save and Continue</button>
                                    </li>
                                    <li>
                                        <a href="javascript:void(0);" onclick="_btncancel();" class="btn btn-primary   btncancel"> Cancel</a>
                                    </li>
                                </ul>
                            </div>

                            <div class="tab-pane" role="tabpanel" id="step2">
                                <div id="divstep2">
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <div class="form-group row">
                                                <span class="col-sm-3 "> Attachment Required </span>
                                                <div class="col-sm-4 form-check">
                                                    <label class="form-check-label">
                                                        <input type="checkbox" id="chkAttachmentRequired" value="1" class="form-check-input is_informationonlyenable">

                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-sm-12">
                                            <div class="form-group row">
                                                <span class="col-sm-3 ">Gender <span class="text-danger">*</span></span>
                                                <div class="col-sm-4">
                                                    @Html.DropDownList("ddlGender", (IEnumerable<SelectListItem>)ViewBag.Gender, new { @class = "form-control is_informationonlyenable" })
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-sm-12">
                                            <div class="form-group row">
                                                <span class="col-sm-3 ">Leave Year <span class="text-danger">*</span></span>
                                                <div class="col-sm-4">
                                                    @Html.DropDownList("ddlLeaveYear", (IEnumerable<SelectListItem>)ViewBag.LeaveYear, new { @class = "form-control is_informationonlyenable" })
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-sm-12">
                                            <div class="form-group row">
                                                <span class="col-sm-3 ">Credit Frequency <span class="text-danger">*</span></span>
                                                <div class=" col-sm-4 ">
                                                    @Html.DropDownList("ddPeriod", (IEnumerable<SelectListItem>)ViewBag.Period, new { @class = "form-control is_informationonlyenable" })
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <div class="form-group row">
                                                <span class="col-sm-3 ">Credit <span class="text-danger">*</span></span>
                                                <div class=" col-sm-4 form-group">
                                                    @Html.DropDownList("ddlCredit", (IEnumerable<SelectListItem>)ViewBag.Credit, new { @class = "form-control is_informationonlyenable" })
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!--Leave Limits-->
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <div class="form-group row">
                                                <span class="col-sm-3 ">Leave Limits</span>
                                                <div class="col-sm-3">
                                                    <div class="form-check">
                                                        <label class="form-check-label " style="    font-weight: 400;">
                                                            <input type="checkbox" id="chkincludepublicholidays" class="is_informationonlyenable" value="">&nbsp;Include Public Holidays
                                                        </label>
                                                    </div>
                                                    <div class="form-check">
                                                        <label class="form-check-label" style="    font-weight: 400;">
                                                            <input type="checkbox" id="chkincludeweekends" class="is_informationonlyenable" value="">&nbsp;Include Weekends
                                                        </label>
                                                    </div>
                                                    <div class="form-check">
                                                        <label class="form-check-label" style="    font-weight: 400;">
                                                            <input type="checkbox" id="chkyeaeclubbed" class="is_informationonlyenable" value="">&nbsp;Can be clubbed with EL
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-sm-3">
                                                    <div class="form-check">
                                                        <label class="form-check-label" style="    font-weight: 400;">
                                                            <input type="checkbox" id="chkcanbeclubbedwithcl" class="is_informationonlyenable" value="">&nbsp;Can be clubbed with CL
                                                        </label>
                                                    </div>
                                                    <div class="form-check">
                                                        <label class="form-check-label" style="    font-weight: 400;">
                                                            <input type="checkbox" id="chkcanbehalfday" class="is_informationonlyenable" value="">&nbsp;Can be half day
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                    <!--Can Avail-->
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <div class="form-group row">
                                                <span class="col-sm-3">Can Avail In</span>
                                                <div class="col-sm-2">
                                                    <div class="form-check">
                                                        <label class="form-check-label" style="font-weight: 400;">
                                                            <input type="checkbox" id="chkavailprobationperiad" class="can_avail" checked value="">&nbsp;Probation Period
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-sm-2">
                                                    <div class="form-check">
                                                        <label class="form-check-label" style="font-weight: 400;">
                                                            <input type="checkbox" id="chkavailregular" class="can_avail" checked value="">&nbsp;Regular Period
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-sm-2">
                                                    <div class="form-check">
                                                        <label class="form-check-label" style="font-weight: 400;">
                                                            <input type="checkbox" id="chkavailcontract" class="can_avail" checked value="">&nbsp;Contract Period
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-sm-2">
                                                    <div class="form-check">
                                                        <label class="form-check-label" style="font-weight: 400;">
                                                            <input type="checkbox" id="chkavailnoticeperiad" class="can_avail" checked value="">&nbsp;Notice  Period
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-sm-8">
                                            <div class="form-group row">

                                                <div class="col-sm-4 text-left m-b-30">
                                                    <a href="javascript:void(0);" id="planterm" class="btn btn-primary rounded pull-left is_informationonlyenable "><i class="fa fa-plus"></i> &nbsp;&nbsp;Create Rule</a>
                                                </div>
                                                <label class="col-sm-8 col-form-label"></label>
                                            </div>
                                        </div>
                                        <div class="col-sm-4">
                                        </div>
                                    </div>
                                    <!--Create Rule-->
                                    <div class="row">
                                        <div class="col-md-12" style="padding-bottom: 10px">
                                            @*<div class="table-responsive"  style="overflow-y: auto;">*@
                                            <div>

                                                <input type="hidden" id="hdn_count" value="0" />
                                                <table id="tblCreatePlan" style="width:100%" class="table table-striped custom-table m-b-0  is_informationonlyenable tblCreatePlan">
                                                    <thead>
                                                        <tr>
                                                            @*<th style="font-weight: 400;">
                                                                    Grade
                                                                </th>
                                                                <th style="font-weight: 400;">
                                                                    Duration
                                                                </th>
                                                                <th style="font-weight: 400;">
                                                                    UOM
                                                                </th>
                                                                <th style="font-weight: 400;">
                                                                    Start Date
                                                                </th>
                                                                <th style="font-weight: 400;">
                                                                    End Date
                                                                </th>
                                                                <th style="font-weight: 400;">
                                                                    Is loss of Pay
                                                                </th>

                                                                <th style="font-weight: 400;">
                                                                    Employment Type
                                                                </th>
                                                                <th style="font-weight: 400;">
                                                                    Status
                                                                </th>
                                                                <th style="font-weight: 400;">
                                                                    Action
                                                                </th>*@

                                                            <th>
                                                                Grade
                                                            </th>
                                                            <th>
                                                                Duration
                                                            </th>
                                                            <th>
                                                                UOM
                                                            </th>
                                                            <th>
                                                                Start Date
                                                            </th>
                                                            <th>
                                                                End Date
                                                            </th>
                                                            <th>
                                                                Is loss of Pay
                                                            </th>

                                                            <th>
                                                                Employment Type
                                                            </th>
                                                            <th>
                                                                Status
                                                            </th>
                                                            <th>
                                                                Action
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                </table>

                                            </div>

                                        </div>
                                    </div>
                                </div>

                                <ul class="mybtncls pull-right">
                                    <li>
                                        <button type="button" onclick="StepOnePrevious();" class="btn btn-default prev-step">Previous</button>
                                    </li>
                                    <li>
                                        <button type="button" onclick="StepTwo();" value="steptwo" class="btn btn-primary next-step">Save and Continue</button>
                                    </li>
                                    <li>
                                        <a href="#" onclick="_btncancel();" class="btn btn-primary   btncancel"> Cancel</a>
                                    </li>
                                </ul>
                            </div>

                            <div class="tab-pane" role="tabpanel" id="step4">
                                <div id="divstep4">
                                    <div class="row">
                                        <div class="col-sm-8">
                                            <div class="form-group row">
                                                <div class="col-sm-6">
                                                    <div class="form-check ">
                                                        <label class="form-check-label " style="font-weight:400">
                                                            <input type="checkbox" class="year_proccessing" onclick="document.getElementById('txtCarryoverLimit').disabled=!this.checked;" id="chkAllowCarryover" value="Role"> Allow Carryover
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-sm-6 ">
                                                    <div class="form-group row">
                                                        <div class="col-sm-4">
                                                            <span> Carryover Limit</span>
                                                        </div>
                                                        <div class="col-sm-8 ">
                                                            <input type="text" id="txtCarryoverLimit" disabled min="0" maxlength="3" class="form-control mynumvalthreedigit year_proccessing" value="0" />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-sm-4">
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-8">
                                            <div class="form-group row">
                                                <div class="col-sm-6">
                                                    <div class="form-check">
                                                        <label class="form-check-label" style="font-weight:400">
                                                            <input type="checkbox" class="year_proccessing" onclick="document.getElementById('txtPayatYearendMaxBal').disabled=!this.checked;document.getElementById('txtMaximumEncashmentPerYear').disabled=!this.checked;" id="chkPayatYearend" value="Role"> Pay at Year end
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-sm-6 ">
                                                    <div class="form-group row">
                                                        <div class="col-sm-4">
                                                            <span>Min. Balance Need To be Maintained</span>
                                                        </div>
                                                        <div class="col-sm-8 ">
                                                            <input type="text" id="txtPayatYearendMaxBal" disabled maxlength="3" class="form-control mynumvalthreedigit year_proccessing" value="0" />
                                                        </div>
                                                    </div>
                                                    <div class="form-group row">
                                                        <div class="col-sm-4">
                                                            <span>Maximum Encashment Per Year</span>
                                                        </div>
                                                        <div class="col-sm-8 ">
                                                            <input type="text" id="txtMaximumEncashmentPerYear" disabled min="0" maxlength="3" class="form-control mynumvalthreedigit year_proccessing" value="0" />
                                                        </div>
                                                    </div>
                                                </div>

                                            </div>
                                        </div>
                                        <div class="col-sm-4">
                                        </div>
                                    </div>

                                    <div class="row" style="display:none">
                                        <div class="col-sm-8">
                                            <div class="form-group row">
                                                <div class="col-sm-6">
                                                    <div class="form-check">
                                                        <label class="form-check-label " style="font-weight:400">
                                                            <input type="checkbox" class="year_proccessing" onclick="document.getElementById('EncashmentLimit').disabled=!this.checked;document.getElementById('txteligibaleForEncashmentmaxbal').disabled=!this.checked;" id="chkEligibleForEncashment" value="Role">&nbsp;Eligible For Encashment
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-sm-6 ">
                                                    <div class="form-group row">
                                                        <div class="col-sm-4">
                                                            <span>Encashment Limit</span>
                                                        </div>
                                                        <div class="col-sm-8 ">
                                                            <input type="text" id="EncashmentLimit" min="0" disabled maxlength="3" class="form-control mynumvalthreedigit year_proccessing" value="0" />
                                                        </div>
                                                    </div>
                                                    <div class="form-group row">
                                                        <div class="col-sm-4">
                                                            <span>Min. Balance Need To be Maintained</span>
                                                        </div>
                                                        <div class="col-sm-8 ">
                                                            <input type="text" id="txteligibaleForEncashmentmaxbal" disabled min="0" maxlength="3" class="form-control mynumvalthreedigit year_proccessing" value="0" />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-sm-4">
                                        </div>
                                    </div>


                                    <div class="row">
                                        <div class="col-sm-8">
                                            <div class="form-group row">
                                                <div class="col-sm-6">
                                                    <div class="form-check">
                                                        <label class="form-check-label " style="font-weight:400">
                                                            <input type="checkbox" class="year_proccessing" onclick="document.getElementById('txtcarrayforyear').disabled=!this.checked;" id="chkcarrayforwardyear" value="Role"> Carry Forward to EL
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-sm-6 ">
                                                    <div class="form-group row">
                                                        <div class="col-sm-4">
                                                            <span>Carry Forward Limit</span>
                                                        </div>
                                                        <div class="col-sm-8 ">
                                                            <input type="text" id="txtcarrayforyear" disabled min="0" maxlength="3" class="form-control mynumvalthreedigit year_proccessing" value="0" />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-sm-4">
                                        </div>
                                    </div>
                                </div>
                                <ul class="mybtncls pull-right">
                                    <li>
                                        <button type="button" onclick="StepTwoPrevious();" class="btn btn-default prev-step">Previous</button>
                                    </li>
                                    <li>
                                        <button type="button" onclick="StepFour();" class="btn btn-primary btn-info-full next-step">Save and Continue</button>
                                    </li>
                                    <li>
                                        <a href="javascript:void(0);" onclick="_btncancel();" class="btn btn-primary   btncancel"> Cancel</a>
                                    </li>
                                </ul>
                            </div>
                            <div class="tab-pane" role="tabpanel" id="complete">
                                <div id="DivLeavePolicy"></div>
                                <div id="DivLeavePlan"></div>
                                <div id="DivYearEndProcessing"></div>
                                <br />
                                <ul class="mybtncls btnlast pull-left">
                                    <li>
                                        <button type="button" onclick="StepThreePrevious();" class="btn btn-default prev-step">Previous</button>
                                    </li>
                                    <li>
                                        <a href="javascript:void(0);" id="btnsubmitpage" class="btn btn-primary">Submit</a>
                                    </li>
                                    <li>
                                        <a href="javascript:void(0);" onclick="_btncancel();" id="btncancelpage" class="btn btn-primary   btncancel"> Cancel</a>

                                    </li>
                                </ul>
                            </div>
                            <div class="clearfix"></div>
                        </div>
                    </form>
                </div>
            </section>
        </div>
    </div>
</div>
<div id="Create_Plan" class="modal custom-modal fade" role="dialog">
    <div class="modal-dialog">
        <button type="button" id="btn-create-plan-close" class="close" data-dismiss="modal">&times;</button>
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <div class="modal-title">
                    <h4 id="createrulehedding">Create Rule</h4>
                </div>
            </div>
            <div class="modal-body">
                <form>
                    <div class="row">
                        <div class="col-sm-4 form-group">
                            <label>Grade <span class="text-danger">*</span> </label>
                            @Html.DropDownList("ddlgrade", (IEnumerable<SelectListItem>)ViewBag.Grade, new { @class = "form-control", multiple = "true" })
                        </div>
                        <div class=" col-sm-4 form-group">
                            <label>Duration<span class="text-danger">*</span> </label>
                            <input type="text" min="0" maxlength="5" name="name" onkeypress="if(this.value.length==0 && event.keyCode == 48) return false; " class="form-control mynumval" autocomplete="off" id="txtnoofdays" placeholder="Duration" value="" />
                        </div>
                        <div class=" col-sm-4 form-group">
                            <label>UOM <span class="text-danger">*</span> </label>
                            @Html.DropDownList("ddlUOM", (IEnumerable<SelectListItem>)ViewBag.UOM, new { @class = "form-control" })
                        </div>
                        <div class=" col-sm-4 form-group">
                            <label>Start Date <span class="text-danger">*</span> </label>
                            <div class="cal-icon"><input type="text" id="txtStartdatepolicyplan" placeholder="dd-mmm-yyyy" class="form-control mycal"></div>
                        </div>
                        <div class="col-sm-4 form-group">
                            <label>End Date </label>
                            <div class="cal-icon"><input type="text" id="txtEnddatepolicyplan" placeholder="dd-mmm-yyyy" class="form-control mycal"></div>
                        </div>
                        <div class="col-sm-4 form-group">
                            <label>Is loss of Pay <span class="text-danger">*</span>  </label>
                            @Html.DropDownList("ddlislossofpay", (IEnumerable<SelectListItem>)ViewBag.Islosseofpay, new { @class = "form-control" })
                        </div>
                        <div class="col-sm-4 form-group">
                            <label>Employment Type <span class="text-danger">*</span>  </label>
                            @Html.DropDownList("Employeetype", (IEnumerable<SelectListItem>)ViewBag.employertype, new { @class = "form-control" })
                        </div>
                        <div class="col-sm-4 form-group">
                            <label>Status  <span class="text-danger">*</span>  </label>
                            @Html.DropDownList("ddlcreaterulestatus", (IEnumerable<SelectListItem>)ViewBag.statuscreaterule, new { @class = "form-control" })
                        </div>
                    </div>
                    <div id="wait" style="display:none;width:109px;height:100px;position:absolute;top:50%;left:50%;padding:2px;"><img src="~/assets/img/giphy.gif" width="64" height="64" /><br>Loading..</div>
                    <input type="hidden" id="hiddenrowindex" />
                    <input type="hidden" id="hiddenrowgroup" value="1" />
                    <input type="hidden" id="hiddenrowenddate" />
                    <input type="button" id="btnAddCreateRule" class="btn btn-primary" name="Apply" value="Submit" />
                    <input type="button" id="btnreset" class="btn btn-primary" onclick="javascript: clearText();" name="" value="Reset" />
                </form>
            </div>
        </div>
    </div>


</div>

